<!DOCTYPE html>
<html>
<head>
  <title>AR Video Tracking</title>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar-js@1.2.6/dist/mindar-image-three.prod.js"></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
    }
    #ar-container {
      width: 100vw;
      height: 100vh;
    }
    #toggle-button {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 10;
      padding: 10px;
      font-size: 16px;
    }
    #video-player {
      display: none;
    }
  </style>
</head>
<body>
  <button id="toggle-button">Start Camera</button>
  <div id="ar-container"></div>
  <video id="video-player" src="video.mp4" loop></video>
  <script>
    const toggleButton = document.getElementById("toggle-button");
    const videoPlayer = document.getElementById("video-player");
    const arContainer = document.getElementById("ar-container");

    let mindarThree = null;
    let started = false;
    let hiddenCameraElements = [];

    // Check if camera access is available
    async function checkCameraAccess() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        stream.getTracks().forEach(track => track.stop());
        console.log("Camera access granted");
        return true;
      } catch (err) {
        console.error("Camera access denied or unavailable:", err);
        alert("Camera access is required. Please allow camera permissions and ensure you're using HTTPS or localhost.");
        return false;
      }
    }

    // Check if MindAR is loaded
    function checkMindAR() {
      if (!window.MINDAR || !window.MINDAR.IMAGE) {
        console.error("MindAR.IMAGE is not available. Ensure the MindAR script loaded correctly.");
        alert("MindAR library failed to load. Check the console and verify the CDN URL.");
        return false;
      }
      console.log("MindAR.IMAGE is available");
      return true;
    }

    toggleButton.addEventListener("click", async () => {
      if (!started) {
        // Verify camera access
        const hasCameraAccess = await checkCameraAccess();
        if (!hasCameraAccess) return;

        // Verify MindAR
        if (!checkMindAR()) return;

        toggleButton.textContent = "Stop Camera";
        console.log("Initializing MindAR...");

        try {
          // Initialize MindAR
          mindarThree = new window.MINDAR.IMAGE.MindARThree({
            container: arContainer,
            imageTargetSrc: "targets.mind"
          });

          const { renderer, scene, camera } = mindarThree;
          const anchor = mindarThree.addAnchor(0);

          console.log("MindAR initialized, setting up scene...");

          // Create a video texture
          const videoTexture = new THREE.VideoTexture(videoPlayer);
          videoTexture.minFilter = THREE.LinearFilter;
          videoTexture.magFilter = THREE.LinearFilter;

          // Create a material with the video texture
          const videoMaterial = new THREE.MeshBasicMaterial({
            map্র

System: * Today's date and time is 06:00 AM +08 on Saturday, May 17, 2025.
